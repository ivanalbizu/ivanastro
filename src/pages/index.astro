---
import Layout from "@layouts/Layout.astro";
import Hero from "@components/Hero.astro";
import Categories from "@components/Categories.astro";
import PostMeta from "@components/PostMeta.astro";
import Skills from "@components/Skills.astro";
import Button from "@components/Button.astro";

import { getCollection } from "astro:content";

const base = import.meta.env.BASE_URL;

const posts = await getCollection("blog");

const sortedPosts = posts
  .sort(
    (a: any, b: any) =>
      new Date(b.data.date).getTime() -
      new Date(a.data.date).getTime(),
  )
  .slice(0, 3);
---

<Layout
  title="Maquetador web"
  description="Maquetador web. Puedes ver publicaciones sobre html, css, sass, javascript, webgl, astro, wordpress, java, android."
  showSidebar={false}
>
  <Hero />

  <section class="container" id="latest-entries">
    <h2 class="section-title">Últimas entradas</h2>
    <p class="section-subtitle">
      Entradas principalmente sobre html, css, scss, webgl, vue, accesibilidad
      web.
    </p>
    {
      sortedPosts.length > 0 && (
        <div class="section-content">
          {sortedPosts.map((post) => (
            <article class="post">
              <h3 class="post__title">
                <a
                  href={`${base}blog/${post.data.slug}`}
                >
                  {post.data.title}
                </a>
              </h3>

              <PostMeta frontmatter={post.data} showExcerpt={false} />
            </article>
          ))}
        </div>
      )
    }
    <div class="section-footer">
      <Button tag="a" variant="secondary" size="sm" href={`${base}blog`}
        >Ir al Blog</Button
      >
    </div>
  </section>

  <section class="container" id="main-categories">
    <h2 class="section-title">Principales categorías</h2>
    <p class="section-subtitle">Categorías más relevantes del Blog.</p>
    <div class="section-content">
      <Categories limitRecentCategories={5} tag="h3" />
    </div>
    <div class="section-footer">
      <Button tag="a" variant="secondary" size="sm" href={`${base}categorias`}
        >Ver todas las categorías</Button
      >
    </div>
  </section>

  <section class="container" id="technology-stack">
    <h2 class="section-title"><span lang="en">Stack</span> tecnológico</h2>
    <p class="section-subtitle">
      Algunas de las tecnologías y herramientas que mejor conozco.
    </p>
    <div class="section-content">
      <Skills />
    </div>
    <div class="section-footer">
      <Button tag="a" variant="secondary" size="sm" href={`${base}sobre-mi/`}
        >Más sobre mí</Button
      >
    </div>
  </section>
</Layout>

<style lang="scss">
  .container {
    padding: var(--space-xxl) 0;
  }

  .section-title {
    font-family: var(--typography-font-family-primary);
    font-size: var(--typography-font-size-heading-3);
    font-weight: var(--typography-font-weight-bold);
    color: var(--color-accent);
    text-transform: uppercase;
    letter-spacing: 0.03em;
    margin-block-end: var(--space-sm);
    text-align: center;
  }

  .section-subtitle {
    text-align: center;
    font-size: var(--typography-font-size-heading-5);
    line-height: var(--typography-line-height-lg);
    color: var(--color-text-secondary);
    margin-block-end: var(--space-xl);
    max-width: var(--max-width-thin);
    margin-inline: auto;
  }

  .section-content {
    display: grid;
    gap: var(--space-lg);
    margin-block-end: var(--space-xl);
  }

  .post {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius-lg);;
    padding: var(--space-md);
    transition:
      transform var(--transition-duration-normal) ease,
      border-color var(--transition-duration-normal) ease;
    &__title {
      font-family: var(--typography-font-family-primary);
      font-size: var(--typography-font-size-heading-5);
      font-weight: var(--typography-font-weight-bold);
      margin-block-end: var(--space-xxs);
      a {
        color: var(--color-text-primary);
        text-underline-offset: 3px;
        &:hover,
        &:focus {
          color: var(--color-interaction-default);
        }
      }
    }
  }

  .section-footer {
    text-align: center;
  }
</style>
